<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />









  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="教会机器通过深度学习和自我博弈学习玩《四子连珠》游戏（Connect4）。">
<meta property="og:type" content="article">
<meta property="og:title" content="用Python和Keras搭建你自己的AlphaZero（转自景略集智）">
<meta property="og:url" content="https://zzy99.github.io/2018/06/08/2/index.html">
<meta property="og:site_name" content="四度空间">
<meta property="og:description" content="教会机器通过深度学习和自我博弈学习玩《四子连珠》游戏（Connect4）。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/19c47b3d840aebdb8a1029f22222836b.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/2c806017f17181390a9a7f4eb0d173d1.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/af9f5d5df0bf62bcd069a331a34a97f9.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/4b2549a0552c570ae0f3646877de578a.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/d57ddcb52c9711951aa3e3a58909e7b0.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/966befa2185bedf16e584760bd255ead.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/0dd3ac8572f1027e3ed78ff4b65e5551.jpg">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/394b9da60d9589070f35d7177416a3d8.jpg">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b0000501bb1?w=244&h=82&f=jpeg&s=6874">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b104cecf8e2?w=1000&h=1012&f=jpeg&s=439756">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b135b6b4dde?w=1000&h=381&f=jpeg&s=183358">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b197c3fe043?w=781&h=512&f=jpeg&s=61188">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b1d216f9034?w=914&h=1296&f=jpeg&s=178259">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b258bc6f4a1?w=1000&h=1282&f=jpeg&s=598482">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/2/8/16174b2b685ce82c?w=1000&h=1352&f=jpeg&s=633602">
<meta property="og:image" content="https://jizhi-10061919.file.myqcloud.com/blog/313a3d8dfe11bb4a8c7c7577f5e1091f.jpg">
<meta property="og:updated_time" content="2018-06-07T16:30:40.626Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用Python和Keras搭建你自己的AlphaZero（转自景略集智）">
<meta name="twitter:description" content="教会机器通过深度学习和自我博弈学习玩《四子连珠》游戏（Connect4）。">
<meta name="twitter:image" content="https://jizhi-10061919.file.myqcloud.com/blog/19c47b3d840aebdb8a1029f22222836b.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zzy99.github.io/2018/06/08/2/"/>





  <title>用Python和Keras搭建你自己的AlphaZero（转自景略集智） | 四度空间</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">四度空间</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">朱政烨的BLOG</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            目录
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zzy99.github.io/2018/06/08/2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="朱政烨">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="四度空间">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">用Python和Keras搭建你自己的AlphaZero（转自景略集智）</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-08T00:00:00+08:00">
                2018-06-08
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-06-08T00:30:40+08:00">
                2018-06-08
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习-深度学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习\深度学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/06/08/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/06/08/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://jizhi-10061919.file.myqcloud.com/blog/19c47b3d840aebdb8a1029f22222836b.jpg" alt=""></p>
<p><strong>教会机器通过深度学习和自我博弈学习玩《四子连珠》游戏（Connect4）。</strong></p>
<a id="more"></a>
<p>在本文，我（作者 David Foster——译者注）会主要讲到以下三件事：</p>
<ul>
<li><p>AlphaZero 迈入人工智能一大步的两个原因。</p>
</li>
<li><p>你怎样可以搭建一个 AlphaZero 一样的AI玩《四子连珠》游戏。</p>
</li>
<li><p>你怎样可以将代码适用到其它游戏中。</p>
</li>
</ul>
<p><strong>AlphaGo → AlphaGo Zero → AlphaZero</strong></p>
<p>2016 年 3 月，在 2 百万人眼前，DeepMind 的 AlphaGo 以 4-1 击败了世界围棋冠军李世石。一台机器学到了人类顶尖的围棋策略，这在以前是难以想象的事情。</p>
<p>就其自身而言，这已经是了不起的成就了，然而 2017 年 10 月，DeepMind 又往前迈了一大步。</p>
<p>在其发布的《Mastering the Game of Go without Human Knowledge》（无需人类知识掌握围棋）中，DeepMind 展示了一种新算法 AlphaGo Zero，它以 100-0 的战绩击败的自己的旧版本 AlphaGo。令人难以置信的是，AlphaGo Zero 完全是通过自我博弈学习，从“白板”开始，逐渐找到了能打败 AlphaGo 的策略。创建一个这样的超级人工智能已经完全不需要任何人类专业知识构成的数据库进行训练。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/2c806017f17181390a9a7f4eb0d173d1.jpg" alt="img"></p>
<p>仅仅 48 天后的 2017 年 12 月 5 日，DeepMind 又发表了另一篇论文《Mastering Chess and Shogi by Self-Play with a General Reinforcement Learning Algorithm》（用通用强化学习算法自我对弈，掌握国际象棋和将棋），显示 AlphaGo Zero 也能打败国际象棋世界冠军 StockFish 和日本将棋冠军 Elmo。而整个学习过程，从展示给 AlphaGo Zero 这些棋类开始到它成为这两种棋的世界顶尖高手，只用了不到 24 小时。</p>
<p>在这种情况下，AlphaZero 诞生了——一种无需预先获得人类专业知识就能迅速掌握某些领域技能的通用算法。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/af9f5d5df0bf62bcd069a331a34a97f9.jpg" alt="img"></p>
<p>对于这项成就，有两个方面很奇妙：</p>
<p><strong>1.AlphaZero 无需任何人类专业知识作为输入</strong></p>
<p>这一点的重要性，再强调也不为过。这意味着如果有完善的信息（如果自始至终双方都完全知道下棋状态），AlphaGo Zero 的根本方法可以用到任何棋类游戏中，因为除了该种棋类的规则之外，AI 无需预先学习任何专业知识。</p>
<p>这就是为何 DeepMind 在发布初篇 AlphaGo Zero 论文后不到 48 天就能发布打败国际象棋和将棋人类冠军的论文。简单说，所需的改变就只有描述棋类机制的输入文件，以及调整与神经网络和蒙特卡洛树搜索相关的高参数。</p>
<p><strong>算法非常优雅</strong></p>
<p>即便 AlphaZero 使用了超级复杂的算法，当今世界只有一小部分人能理解，那么它依然算的上是了不起的成就。然而，它的非凡之处就在于论文中的很多理念实际上远比之前的版本简单。其核心思想，就是遵循这些简单的学习口诀一样的东西：</p>
<ul>
<li>从内心先将所有可能会出现的场景过一遍，优先选择有希望的路径，同时也思考对手对你的行动最可能做出怎样的反应，并继续探索未知情境。</li>
<li>抵达不熟悉的状态后，评估一下你认为当前情形对自己是否有利，关联一下前几步的得分，分析走到当前这一步的心理路径。</li>
<li>在考虑完将来所有的可能性后，采取探索最多的行动。</li>
<li>在比赛结束时，回溯并评估当时对未来场景出现了哪些误判，相应地优化对这些场景的理解。</li>
</ul>
<p>这和你学习下棋的过程是不是很像？当你下了一步坏棋，要么是因为你误判了走这步棋的未来情况，要么你误判了对手可能会怎么下，因此没有考虑到这中可能性。而正是从这两个方面训练 AlphaZero 学习下棋。</p>
<p><strong>怎样搭建你自己的 AlphaZero</strong></p>
<p>本文主要是讲解如何搭建AlphaZero，因此假定你已经对AlphaZero的原理有了大致了解。如果不太熟悉的，可预先查阅一下相关资料，可以参考我制作的这篇<a href="https://medium.com/applied-data-science/alphago-zero-explained-in-one-diagram-365f5abf67e0" target="_blank" rel="noopener">速查表</a>或这篇<a href="http://tim.hibal.org/blog/alpha-zero-how-and-why-it-works/" target="_blank" rel="noopener">文章</a>。</p>
<p><strong>代码</strong></p>
<p>将 Github 上的代码库复制下来</p>
<p><a href="https://github.com/AppliedDataSciencePartners/DeepReinforcementLearning" target="_blank" rel="noopener">https://github.com/AppliedDataSciencePartners/DeepReinforcementLearning</a></p>
<p>我后面会引用这里面的代码。</p>
<p>要开始学习过程，首先在 run.ipynb Jupyter notebook 中运行前两个面板。一旦它创建了足够的博弈情景，神经网络就开始训练了。</p>
<p>再通过自我博弈和训练，它会越来越擅长在任何位置预测博弈值和下一步棋的动作，从而做出更好的决策，越来越聪明。</p>
<p>现在我们更详细地看看代码，并展示一些结果，证明 AI 随着时间推移越来越强。</p>
<p>注意：这是我自己根据 DeepMind 所发论文对 AlphaZero 的理解，如有不当之处，敬请指正。</p>
<p><strong>《四子连珠》</strong></p>
<p>我们的算法要学习玩的游戏是《四子连珠》（Connect4）。虽然它不像围棋那么复杂，但是仍然总共有 4,531,985,219,092 个游戏位置。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/4b2549a0552c570ae0f3646877de578a.jpg" alt="img"></p>
<p>游戏的规则很直接：<strong>玩家轮流在任何一栏的顶部放置自己的颜色的棋子。谁最先在垂直、水平或对角线上都放置了同一种颜色，则获胜。如果全部网格都被填满，仍然没有出现同一颜色的棋子出现在同一条线上，则平局。</strong></p>
<p>以下是组成代码库的关键文件的总结：</p>
<p><strong>game.py</strong></p>
<p>该文件包含《四子连珠》的游戏规则。</p>
<p>每个方格分配一个从0到41的数字，如图：</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/d57ddcb52c9711951aa3e3a58909e7b0.jpg" alt="img"></p>
<p>此文件给出了根据给定动作，从一种游戏状态转移至另一种的逻辑。例如，给定空棋盘和 38 号动作，takeAction 方法返回到一个新的游戏状态，起始玩家的位置则位于中间列的底部。</p>
<p>你可以用任何符合相同 API 的游戏文件替换 game.py 文件，原则上算法将根据你给它的规则通过自我博弈学习游戏策略。</p>
<p><strong>run.ipynb</strong></p>
<p>它包含了开始学习过程的代码。它会加载游戏规则，然后迭代算法的主循环，其中包含三个阶段：</p>
<ul>
<li>自我博弈</li>
<li>再训练神经网络</li>
<li>评估神经网络</li>
</ul>
<p>在这一循环中有两个 agent：best_player 和 current_player。</p>
<p>其中 best_player 包含了性能最好的神经网络，用于生成自我博弈记忆。Current_player 然后会根据这些记忆再训练其神经网络，接着与 best_player 进行对弈。如果它赢了， best_player 中的神经网络就会换成 current_player 中的神经网络，循环再次开始。</p>
<p><strong>agent.py</strong></p>
<p>它包含 Agent类（游戏中的一个玩家）。每个玩家都用自己的神经网络和蒙特卡罗搜索树进行初始化。</p>
<p>Simulate 方法运行蒙特卡罗树搜索过程。具体说来，agent 移动至树的一个叶节点，用其神经网络评估该节点，然后通过树回填（backfill）该节点的值。</p>
<p>Act 方法多次重复 simulate 方法，以理解从当前位置移动至哪个位置是最有利的。然后它将选定的动作返回给游戏，以执行该游戏。</p>
<p>replay 方法使用之前的游戏记忆再训练神经网络。</p>
<p><strong>Model.py</strong></p>
<p>该文件包含了 Residual_CNN 类，它定义如何构建神经网络的实例。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/966befa2185bedf16e584760bd255ead.jpg" alt="用Keras搭建的一个残留卷积神经网络样例">用Keras搭建的一个残留卷积神经网络样例</p>
<p>其采用 AlphaGo Zero 论文中的神经网络架构的压缩版本——即一个卷积层，接着是一些残留层，然后分解成值端（value head）和策略端（policy head）。</p>
<p>卷积过滤器的深度和数量可以在 config 文件中设置。</p>
<p>Keras 程序库用于搭建神经网络，使用 TensorFlow 后端。</p>
<p>要在神经网络中查看单个卷积过滤和密集连接的层，可在 run.ipynb notebook 中运行以下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">current_player.model.viewLayers()</span><br></pre></td></tr></table></figure>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/0dd3ac8572f1027e3ed78ff4b65e5551.jpg" alt="神经网络中的卷积过滤器">神经网络中的卷积过滤器</p>
<p><strong>MCTS.py</strong></p>
<p>它包含节点、边缘和 MCTS 类，它们构成了一个蒙特卡洛搜索树。</p>
<p>MCTS 类包含前面提到的 moveToLeaf 和 backFill 方法，并且边缘类的实例存储每个可能的移动的统计数据。</p>
<p><strong>config.py</strong></p>
<p>这是你设置影响算法的关键参数的地方。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/394b9da60d9589070f35d7177416a3d8.jpg" alt="img"></p>
<p>调整这些变量将影响算法的运行时间、神经网络的准确性和算法的整体成功。上面的参数产生了一个高质量的《四子连珠》玩家，但是要花很长时间才能完成。为了加快算法的速度，请尝试以下参数。</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b0000501bb1?w=244&amp;h=82&amp;f=jpeg&amp;s=6874" alt="img"></p>
<p><strong>funcs.py</strong></p>
<p>它包含了将两个 agent 进行匹配的 playMatches 和 playMatchesBetweenVersions 函数。</p>
<p>如果要和你创建的玩家对战，请运行以下代码(它也在 run.ipynb notebook 中)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from game import Game</span><br><span class="line">from funcs import playMatchesBetweenVersions</span><br><span class="line">import loggers as lg</span><br><span class="line">env = Game()</span><br><span class="line">playMatchesBetweenVersions(</span><br><span class="line">env</span><br><span class="line">, 1  # the run version number where the computer player is located</span><br><span class="line">, -1 # the version number of the first player (-1 for human)</span><br><span class="line">, 12 # the version number of the second player (-1 for human)</span><br><span class="line">, 10 # how many games to play</span><br><span class="line">, lg.logger_tourney # where to log the game to</span><br><span class="line">, 0  # which player to go first - 0 for random</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><strong>initialise.py</strong></p>
<p>当你运行该算法时，所有的模型和内存文件都保存在 run 文件夹中，在根目录中。</p>
<p>稍后要从这个检查点重新启动算法，将 run 文件夹转移到 run_archive 文件夹中，将一个运行编号（run number）附加到文件夹名字上。然后，将运行编号、模型版本号和 memory 版本号输入到 initialise.py 文件中，run_archive 文件夹中相关文件的位置对应。然后从这个检查点开始，像往常一样运行该算法。</p>
<p><strong>memory.py</strong></p>
<p>这是 Memory class 的一个实例，用以存储之前游戏的记忆，该算法会用它们重新训练 current_player 的神经网络。</p>
<p><strong>loss.py</strong></p>
<p>此文件包含一个自定义损失函数，用以在传递到交叉熵损失函数之前对非法移动的预测进行掩码处理。</p>
<p><strong>settings.py</strong></p>
<p>run和run_archive 文件夹的位置。</p>
<p><strong>logger.py</strong></p>
<p>这个文件包含一个自定义的损失函数，它在传递到交叉熵损失函数之前，掩盖了非法移动的预测。</p>
<p><strong>settings.py</strong></p>
<p>run 和 run_archive 文件夹的位置。</p>
<p><strong>loggers.py</strong></p>
<p>日志文件被保存到 run 文件夹中的 log 文件夹。要打开日志记录，可将该文件中 logger_disabled 变量的值设置为“False”。查看日志文件将帮助你了解算法的工作原理，并了解它的“思想”。例如，下面是 logger.mcts 文件中的一个样例：</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b104cecf8e2?w=1000&amp;h=1012&amp;f=jpeg&amp;s=439756" alt="img"></p>
<p>同样来自 logger.tourney 文件的一个样例，你可以在评估阶段看到每个与移动相关的概率：</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b135b6b4dde?w=1000&amp;h=381&amp;f=jpeg&amp;s=183358" alt="img"></p>
<p><strong>结果</strong></p>
<p>经过几天的训练，小批量迭代次数后得出以下损失图表:</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b197c3fe043?w=781&amp;h=512&amp;f=jpeg&amp;s=61188" alt="img"></p>
<p>最上面的线是策略端的误差(MCTS的交叉熵移动概率与神经网络的输出相对应)。下面的线是值端的误差(实际博弈值与神经网络值之间的均方差)。中间的线是两者的平均值。</p>
<p>很明显，神经网络在预测每个博弈状态的价值和可能的下一步动作方面做得越来越好。为了展示这一结果如何变得更加强大，我在17个玩家之间进行了一场联赛，从首次迭代的神经网络到第 49 次迭代，每对搭档都对战了两次，两名玩家都有机会先玩。</p>
<p>以下是最终排名:</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b1d216f9034?w=914&amp;h=1296&amp;f=jpeg&amp;s=178259" alt="img"></p>
<p>显然，后期版本的神经网络优于早期版本，赢得了它们之间的大部分比赛。另外，学习似乎并没有达到饱和，因为随着训练时间增加，玩家变得越来越强大，并且学习的策略越来越复杂。</p>
<p>例如，随着时间的推移，神经网络所偏爱的一个明确策略就是尽早枪战中心栏。观察算法的第 1 个版本和第 30 个版本之间的差别:</p>
<p><strong>神经网络的第一个版本</strong></p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b258bc6f4a1?w=1000&amp;h=1282&amp;f=jpeg&amp;s=598482" alt="img"></p>
<p><strong>神经网络的第三十个版本</strong></p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/8/16174b2b685ce82c?w=1000&amp;h=1352&amp;f=jpeg&amp;s=633602" alt="img"></p>
<p>这是一个很好的策略，因为很多下棋的线路都需要中间栏——要求尽量不要让对手利用这一点。而神经网络在没有任何人类知识输入的情况下，已经学会了这一点。</p>
<p><strong>学习一种不同的博弈游戏</strong></p>
<p>在 games 文件夹里有个 game.py 文件，用于一个叫做 Metasquares 的游戏。这个游戏是在网格中放置 X 和 O 标记，以尝试形成不同大小的方块。方块越大，玩家分数越高。当网格被填满时，得分最多的玩家获胜。</p>
<p><img src="https://jizhi-10061919.file.myqcloud.com/blog/313a3d8dfe11bb4a8c7c7577f5e1091f.jpg" alt="img"></p>
<p>如果你将《四子连珠》的 game.py 文件替换为 Metasquare 的 game.py 文件，那么我们上面使用的算法就会学习玩 Metasquares 游戏。</p>
<p>换言之，通过这种方式，我们搭建的模型可以学习任何一种博弈游戏。</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏~</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="朱政烨 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="朱政烨 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/04/001/" rel="next" title="kaggle入门 | Digit Recognizer准确度100%">
                <i class="fa fa-chevron-left"></i> kaggle入门 | Digit Recognizer准确度100%
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="朱政烨" />
            
              <p class="site-author-name" itemprop="name">朱政烨</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zzy99" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:80431395@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://www.zhihu.com/people/_zzy_" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">朱政烨</span>

  
</div>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("06/04/2018 21:00:00");//此处修改你的建站时间或者网站上线时间 
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  









  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  

  
  
    <script id="ribbon" type="text/javascript" size="100" alpha="0.2"  zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'm5iyr4lfjTptIqNLHmUn3nk9-gzGzoHsz',
        appKey: 'TajMgponUPGPQAnUzIac21tM',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
        avatar:'wavatar',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "default";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  

 <!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/click.js"></script>
</body>
</html>
